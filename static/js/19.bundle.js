(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{112:function(e,t){},518:function(e,t,n){"use strict";n.r(t);var d=n(0),a=n(66),p=(n(196),n(59),n(12)),r=(n(34),n(16)),m=n(14),c=n(13);n(37),n(112);function s(e){var t=e.paper_name,n=e.description,a=e.questions_count,r=e.onJump,s=e.onPause,o=e.answers,i=e.btnDisabled;return d.createElement("div",{className:"sider"},d.createElement("p",{className:"sider-title"},t),d.createElement("p",{className:"sider-description"},n),d.createElement("div",{className:"sider-btn-group"},new Array(a).fill(0).map(function(e,t){return d.createElement(c.a,{disabled:i,className:"sider-button",type:o[t]&&-1!==o[t]?"primary":"default",onClick:function(){return r(t)}},t+1)})),d.createElement(c.a,{icon:"pause",type:"danger",size:"large",onClick:s},"暂停下次再做"))}var f=n(77),b=(n(173),n(52)),o=(n(140),n(218)),h=n.n(o),i=n(219),v=n.n(i),g=n(19);function l(e){var t=e.onChange,n=e.index,a=e.defaultValue,r=e.value,s=e.btnDisabled,o=e.question,i=o.question,c=o.multiple,l=o.question_img,u=o.answers,p=o.answers_img;return d.createElement(g.a,null,d.createElement("div",{className:"content"},d.createElement("div",{className:"content-question"},d.createElement("p",{className:"content-question-title"},n+1,". ",i," ",c?"(多选)":null),l?d.createElement("img",{className:"content-question-img",src:l,alt:"question_img"}):null),d.createElement("div",{className:"content-answers"},c?d.createElement(h.a,{value:r,defaultValue:a,onChange:t,disabled:s},u.map(function(e,t){return d.createElement(b.a,{value:t+1,checked:r.includes(e),className:"content-answers-option"},d.createElement("p",{className:"content-answers-option-text"},e),p[t]?d.createElement("img",{className:"content-answers-option-img",src:p[t],alt:"answer_img"}):null)})):d.createElement(v.a,{value:r,defaultValue:a,onChange:t,disabled:s},u.map(function(e,t){return d.createElement(f.a,{value:t+1,className:"content-answers-option"},d.createElement("p",{className:"content-answers-option-text"},e),p[t]?d.createElement("img",{className:"content-answers-option-img",src:p[t],alt:"answer_img"}):null)})))))}function u(e){var t=e.canNext,n=e.canSubmit,a=e.canPrevious,r=e.onNext,s=e.onPrevious,o=e.btnDisabled,i=e.onSubmit;return d.createElement("div",{className:"operations"},d.createElement(c.a,{type:"primary",size:"large",shape:"circle",icon:"left",disabled:!a||o,onClick:s,className:"operations-button"}),(t||!n)&&d.createElement(c.a,{icon:"right",type:"primary",size:"large",shape:"circle",disabled:!t,onClick:r,className:"operations-button"}),n&&d.createElement(c.a,{type:"primary",size:"large",disabled:!n||o,className:"operation-submit",onClick:i},"提交"))}var w,y=(w=function(e,t){return(w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}w(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),N=function(){return(N=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},P=function(e,t,n,a){var r,s=arguments.length,o=s<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var i=e.length-1;0<=i;i--)(r=e[i])&&(o=(s<3?r(o):3<s?r(t,n,o):r(t,n))||o);return 3<s&&o&&Object.defineProperty(t,n,o),o},x=function(s,o,i,c){return new(i||(i=Promise))(function(e,t){function n(e){try{r(c.next(e))}catch(e){t(e)}}function a(e){try{r(c.throw(e))}catch(e){t(e)}}function r(t){t.done?e(t.value):new i(function(e){e(t.value)}).then(n,a)}r((c=c.apply(s,o||[])).next())})},E=function(n,a){var r,s,o,e,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,s&&(o=2&t[0]?s.return:t[0]?s.throw||((o=s.return)&&o.call(s),0):s.next)&&!(o=o.call(s,t[1])).done)return o;switch(s=0,o&&(t=[2&t[0],o.value]),t[0]){case 0:case 1:o=t;break;case 4:return i.label++,{value:t[1],done:!1};case 5:i.label++,s=t[1],t=[0];continue;case 7:t=i.ops.pop(),i.trys.pop();continue;default:if(!(o=0<(o=i.trys).length&&o[o.length-1])&&(6===t[0]||2===t[0])){i=0;continue}if(3===t[0]&&(!o||t[1]>o[0]&&t[1]<o[3])){i.label=t[1];break}if(6===t[0]&&i.label<o[1]){i.label=o[1],o=t;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(t);break}o[2]&&i.ops.pop(),i.trys.pop();continue}t=a.call(n,i)}catch(e){t=[6,e],s=0}finally{r=o=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},S=function(e){return{getTestPaper:e.httpResponse.getTestPaper,answers:e.test.answers}},_=function(n){return{setAnswers:function(e){return n(Object(m.setAnswers)(e))},setAnswer:function(e,t){return n(Object(m.setAnswer)({answer:e,index:t}))}}},D=function(e){function t(){var i=null!==e&&e.apply(this,arguments)||this;return i.state={index:-1,total:-1,canNext:!1,canPrevious:!1,canSubmit:!1,loading:!1,value:[],btnDisabled:!1},i.getContentProps=function(){var e=i.state,t=e.index,o=e.total,n=e.value,a=e.btnDisabled,r=i.props.getTestPaper.data.questions[t],s=i.getDefaultValue(t);return{question:r,value:n&&n.length?n:s,defaultValue:s,index:t,btnDisabled:a,onChange:function(e){var t,n=i.state.index,a=n+1===o,r=e.target?e.target.value:e;if(console.log(r),r instanceof Object)if(r.length){for(var s=0;s<r.length;s++)r[n]||r.splice(n,1);t=parseInt(r.join(""),10)}else t=void 0;else t=r;i.setState({canSubmit:a,value:r}),t&&i.props.setAnswer(t,n)}}},i.getOperationProps=function(){var e=i.props.match.params.id,t=i.state;return{id:e,canNext:t.canNext,canPrevious:t.canPrevious,canSubmit:t.canSubmit,btnDisabled:t.btnDisabled,onNext:i.onNext,onPrevious:i.onPrevious,onSubmit:function(){return i.uploadAnswers(!0)}}},i.getSiderProps=function(){var e=i.state.btnDisabled,t=i.props,n=t.getTestPaper,a=t.answers,r=n.data;return{btnDisabled:e,paper_name:r.paper_name,description:r.description,questions_count:r.questions_count,answers:a,onJump:i.onJump,onPause:function(){return i.uploadAnswers(!1)}}},i.onPrevious=function(){var e=i.state.index,t=i.getDefaultValue(e-1);i.setState({canSubmit:!1,canNext:!0,canPrevious:!(e-1==0),index:e-1,value:t})},i.onNext=function(){var e=i.state,t=e.index,n=t+2===e.total,a=!n,r=n,s=i.getDefaultValue(t+1);i.setState({canNext:a,canSubmit:r,value:s,canPrevious:!0,index:t+1})},i.onJump=function(e){var t=i.getDefaultValue(e),n=0===e,a=e+1===i.state.total;i.setState({value:t,canPrevious:!n,canNext:!a,index:e})},i.uploadAnswers=function(o){return x(i,void 0,void 0,function(){var t,n,a,r,s;return E(this,function(e){switch(e.label){case 0:t=this.props.match.params.id,n=this.props,a=n.answers,r=n.history,s=p.a.loading(""),e.label=1;case 1:return e.trys.push([1,,3,4]),this.setState({btnDisabled:!0}),[4,m.actionsMap.uploadAnswers({url:"/api/test/"+t,method:"post",data:{answers:a,finished:o}})];case 2:return e.sent(),r.push("/papers"),[3,4];case 3:return s(),this.setState({btnDisabled:!1}),[7];case 4:return[2]}})})},i.getDefaultValue=function(e){var t=i.props,n=t.getTestPaper,a=t.answers,r=n.data.questions[e],s=a[e];return r.multiple?s?s.toString().split("").map(function(e){return parseInt(e,10)}):[]:s||-1},i}return y(t,e),t.prototype.componentDidMount=function(){return x(this,void 0,void 0,function(){var t,n,a,r,s,o,i,c,l,u;return E(this,function(e){switch(e.label){case 0:t=this.props.match.params.id,n=p.a.loading("",0),e.label=1;case 1:return e.trys.push([1,,3,4]),this.setState({loading:!0}),[4,m.actionsMap.getTestPaper({url:"/api/test/"+t,method:"get"})];case 2:return e.sent(),a=this.props.getTestPaper.data,r=a.answers,s=a.questions_count,o=a.answered_count,this.props.setAnswers(r),i=r.length,c=0===i,u=(l=i===s)&&o===s,this.setState({canSubmit:u,index:l?i-1:i,canNext:!l,canPrevious:!c,total:s}),[3,4];case 3:return n(),this.setState({loading:!1}),[7];case 4:return[2]}})})},t.prototype.render=function(){var e=this.state.index;return d.createElement(a.a,{className:"test"},-1===e?null:d.createElement(d.Fragment,null,d.createElement(a.a.Sider,{width:300,className:"test-sider"},d.createElement(s,N({},this.getSiderProps()))),d.createElement(a.a.Content,{className:"test-content"},d.createElement(l,N({},this.getContentProps())),d.createElement(u,N({},this.getOperationProps())))))},t=P([Object(r.connect)(S,_)],t)}(d.Component);t.default=D}}]);